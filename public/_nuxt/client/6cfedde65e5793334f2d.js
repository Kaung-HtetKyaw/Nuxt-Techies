(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{682:function(e,t,r){const o=r(683);e.exports=o.withScope("nuxt:firebase")},683:function(e,t,r){e.exports=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,r,o){return r&&t(e.prototype,r),o&&t(e,o),e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function c(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=a(e))){var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n,s=!0,i=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return s=e.done,e},e:function(e){i=!0,n=e},f:function(){try{s||null==o.return||o.return()}finally{if(i)throw n}}}}var u={};u[u.Fatal=0]="Fatal",u[u.Error=0]="Error",u[u.Warn=1]="Warn",u[u.Log=2]="Log",u[u.Info=3]="Info",u[u.Success=3]="Success",u[u.Debug=4]="Debug",u[u.Trace=5]="Trace",u[u.Silent=-1/0]="Silent",u[u.Verbose=1/0]="Verbose";var f={silent:{level:-1},fatal:{level:u.Fatal},error:{level:u.Error},warn:{level:u.Warn},log:{level:u.Log},info:{level:u.Info},success:{level:u.Success},debug:{level:u.Debug},trace:{level:u.Trace},verbose:{level:u.Trace},ready:{level:u.Info},start:{level:u.Info}},h=!1,d=[],y=function(){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var o in e(this,t),this._reporters=r.reporters||[],this._types=r.types||f,this.level=void 0!==r.level?r.level:3,this._defaults=r.defaults||{},this._async=void 0!==r.async?r.async:void 0,this._stdout=r.stdout,this._stderr=r.stderr,this._mockFn=r.mockFn,this._throttle=r.throttle||2e3,this._types)this[o]=this._wrapLogFn(Object.assign({type:o},this._types[o],this._defaults));this._mockFn&&this.mockTypes(),this._lastLogSerialized=void 0,this._lastLog=void 0,this._lastLogTime=void 0,this._lastLogCount=0,this._throttleTimeout=void 0}return r(t,[{key:"create",value:function(e){return new t(Object.assign({reporters:this._reporters,level:this.level,types:this._types,defaults:this._defaults,stdout:this._stdout,stderr:this._stderr,mockFn:this._mockFn},e))}},{key:"withDefaults",value:function(e){return this.create({defaults:Object.assign({},this._defaults,e)})}},{key:"withTag",value:function(e){return this.withDefaults({tag:this._defaults.tag?this._defaults.tag+":"+e:e})}},{key:"addReporter",value:function(e){return this._reporters.push(e),this}},{key:"removeReporter",value:function(e){if(e){var t=this._reporters.indexOf(e);if(t>=0)return this._reporters.splice(t,1)}else this._reporters.splice(0);return this}},{key:"setReporters",value:function(e){return this._reporters=Array.isArray(e)?e:[e],this}},{key:"wrapAll",value:function(){this.wrapConsole(),this.wrapStd()}},{key:"restoreAll",value:function(){this.restoreConsole(),this.restoreStd()}},{key:"wrapConsole",value:function(){for(var e in this._types)console["__"+e]||(console["__"+e]=console[e]),console[e]=this[e]}},{key:"restoreConsole",value:function(){for(var e in this._types)console["__"+e]&&(console[e]=console["__"+e],delete console["__"+e])}},{key:"wrapStd",value:function(){this._wrapStream(this.stdout,"log"),this._wrapStream(this.stderr,"log")}},{key:"_wrapStream",value:function(e,t){var r=this;e&&(e.__write||(e.__write=e.write),e.write=function(e){r[t](String(e).trim())})}},{key:"restoreStd",value:function(){this._restoreStream(this.stdout),this._restoreStream(this.stderr)}},{key:"_restoreStream",value:function(e){e&&e.__write&&(e.write=e.__write,delete e.__write)}},{key:"pauseLogs",value:function(){h=!0}},{key:"resumeLogs",value:function(){h=!1;var e,t=c(d.splice(0));try{for(t.s();!(e=t.n()).done;){var r=e.value;r[0]._logFn(r[1],r[2])}}catch(e){t.e(e)}finally{t.f()}}},{key:"mockTypes",value:function(e){if(this._mockFn=e||this._mockFn,"function"==typeof this._mockFn)for(var t in this._types)this[t]=this._mockFn(t,this._types[t])||this[t]}},{key:"_wrapLogFn",value:function(e){return function(){if(!h)return this._logFn(e,arguments);d.push([this,e,arguments])}.bind(this)}},{key:"_logFn",value:function(e,t){var r=this;if(e.level>this.level)return!!this._async&&Promise.resolve(!1);var o=Object.assign({date:new Date,args:[]},e);1===t.length&&function(e){return t=e,!("[object Object]"!==Object.prototype.toString.call(t)||!e.message&&!e.args||e.stack);var t}(t[0])?Object.assign(o,t[0]):o.args=Array.from(t),o.message&&(o.args.unshift(o.message),delete o.message),o.additional&&(Array.isArray(o.additional)||(o.additional=o.additional.split("\n")),o.args.push("\n"+o.additional.join("\n")),delete o.additional),o.type="string"==typeof o.type?o.type.toLowerCase():"",o.tag="string"==typeof o.tag?o.tag.toLowerCase():"";var n=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(r._lastLogCount&&(r._log(s(s({},r._lastLog),{},{args:[].concat(i(r._lastLog.args),["(repeated ".concat(r._lastLogCount-(e?1:0)," times)")])})),r._lastLogCount=0),r._lastLog=o,e){if(r._async)return r._logAsync(o);r._log(o)}};clearTimeout(this._throttleTimeout);var a=this._lastLogTime?o.date-this._lastLogTime:0;if(this._lastLogTime=o.date,a<this._throttle)try{var l=JSON.stringify([o.type,o.tag,o.args]),c=this._lastLogSerialized===l;if(this._lastLogSerialized=l,c)return this._lastLogCount++,void(this._throttleTimeout=setTimeout(n,this._throttle))}catch(e){}n(!0)}},{key:"_log",value:function(e){var t,r=c(this._reporters);try{for(r.s();!(t=r.n()).done;)t.value.log(e,{async:!1,stdout:this.stdout,stderr:this.stderr})}catch(e){r.e(e)}finally{r.f()}}},{key:"_logAsync",value:function(e){var t=this;return Promise.all(this._reporters.map((function(r){return r.log(e,{async:!0,stdout:t.stdout,stderr:t.stderr})})))}},{key:"stdout",get:function(){return this._stdout||console._stdout}},{key:"stderr",get:function(){return this._stderr||console._stderr}}]),t}();y.prototype.add=y.prototype.addReporter,y.prototype.remove=y.prototype.removeReporter,y.prototype.clear=y.prototype.removeReporter,y.prototype.withScope=y.prototype.withTag,y.prototype.mock=y.prototype.mockTypes,y.prototype.pause=y.prototype.pauseLogs,y.prototype.resume=y.prototype.resumeLogs;var g,v=function(){function t(r){e(this,t),this.options=Object.assign({},r),this.defaultColor="#7f8c8d",this.levelColorMap={0:"#c0392b",1:"#f39c12",3:"#00BCD4"},this.typeColorMap={success:"#2ecc71"}}return r(t,[{key:"log",value:function(e){var t=e.level<1?console.__error||console.error:1===e.level&&console.warn?console.__warn||console.warn:console.__log||console.log,r="log"!==e.type?e.type:"",o=e.tag?e.tag:"",n=this.typeColorMap[e.type]||this.levelColorMap[e.level]||this.defaultColor,s="\n      background: ".concat(n,";\n      border-radius: 0.5em;\n      color: white;\n      font-weight: bold;\n      padding: 2px 0.5em;\n    "),a="%c".concat([o,r].filter(Boolean).join(":"));"string"==typeof e.args[0]?t.apply(void 0,["".concat(a,"%c ").concat(e.args[0]),s,""].concat(i(e.args.slice(1)))):t.apply(void 0,[a,s].concat(i(e.args)))}}]),t}();return"undefined"!=typeof window&&window.consola||((g=new y({reporters:[new v]})).Consola=y,g.LogLevel=u,g.BrowserReporter=v,g)}()},696:function(e,t,r){const o=r(682),n={working:!1,queue:[],active:[]},l={working:!1,queue:[]};function c(e){return new Promise(t=>{n.queue.push({operation:e,resolve:t}),async function e(){if(n.working)return;n.working=!0;const t=n.queue.shift();if(!t)return void(n.working=!1);const r=await t.operation();t.resolve(r),n.working=!1,e()}()})}e.exports=class{constructor(e,{config:t,sessions:r}){this.firebase=e,this.config=t,this.lifetime=r.sessionLifetime||0,this.loginDelay=r.loginDelay||50}getSession(e,t=!0){const r=n.active.find(s=>s.instance.name===e);return r&&(r.timeout&&(o.debug("session retrieved, aborting removal"),clearTimeout(r.timeout),r.timeout=null),t&&(r.touched=Date.now())),r}getUser(e){const t=this.getSession(e);if(!t){const t=new Error("Missing session for user "+e);throw t.code="nuxt-firebase/missing-session",t}return t.instance.auth().currentUser}startSession(e="[DEFAULT]"){return c(()=>{o.info("starting session for: ",e);const t=this.getSession(e);if(t)return"[DEFAULT]"===e||(t.active++,o.debug("found existing, active sessions: ",t.active)),t.instance;const r=this.firebase.apps.find(a=>a.name===e)||this.firebase.initializeApp(this.config,e);return n.active.push({instance:r,active:1,touched:Date.now()}),o.debug("created, active sessions: ",1),r})}endSession(e="[DEFAULT]"){return c(()=>{o.info("ending session for: ",e);const t=this.getSession(e,!1);if(t&&"[DEFAULT]"!==e&&(t.active--,o.debug("active sessions: ",t.active),t.active<1)){const e=this.lifetime-(Date.now()-t.touched);o.debug("enqueueing session removal in: ",e),t.timeout=setTimeout(()=>{c(()=>async function(e){o.info("deleting session: ",e.instance.name);const t=n.active.findIndex(s=>s.instance.name!==e.instance.name);n.active.splice(t,1),await e.instance.delete()}(t))},e)}})}login(e,t){o.debug("enqueueing login attempt",Date.now());const r=this.getSession(e).instance.auth();return new Promise((e,o)=>{l.queue.push({promise:()=>r.signInWithCustomToken(t),resolve:e,reject:o}),this.dequeueLoginAttempts()})}async dequeueLoginAttempts(){if(l.working)return;l.working=!0;const e=l.queue.shift();if(e){try{o.debug("attempting login: "+Date.now());const{user:t}=await e.promise();e.resolve(t)}catch(t){e.reject(t)}setTimeout(()=>{l.working=!1,this.dequeueLoginAttempts()},this.loginDelay)}else l.working=!1}}}}]);